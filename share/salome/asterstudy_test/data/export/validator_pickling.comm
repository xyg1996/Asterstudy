
DEBUT()

MAIL = LIRE_MAILLAGE(FORMAT='MED', UNITE=20)

M_ROCHER = DEFI_MATERIAU(ELAS=_F(E=15000000000.0, NU=0.3, RHO=0.0))

M_BETON = DEFI_MATERIAU(ELAS=_F(E=32000000000.0, NU=0.2, RHO=2500.0))

CHMATER = AFFE_MATERIAU(
    AFFE=(
        _F(GROUP_MA=('FONDAT', ), MATER=(M_ROCHER, )),
        _F(GROUP_MA=('BARRAGE', ), MATER=(M_BETON, ))
    ),
    MAILLAGE=MAIL
)

MODFEM = AFFE_MODELE(
    AFFE=(
        _F(
            GROUP_MA=('BARRAGE', ),
            MODELISATION=('3D', ),
            PHENOMENE='MECANIQUE'
        ),
        _F(GROUP_MA=('FONDAT', ), MODELISATION=('3D', ), PHENOMENE='MECANIQUE')
    ),
    MAILLAGE=MAIL
)

CHARDDL = AFFE_CHAR_MECA(
    DDL_IMPO=_F(DX=0.0, DY=0.0, DZ=0.0, GROUP_NO=('PILOTE', )),
    LIAISON_UNIF=(
        _F(DDL=('DX', ), GROUP_NO=('NO_BORD', )), _F(
            DDL=('DY', ), GROUP_NO=('NO_BORD', )
        ), _F(DDL=('DZ', ), GROUP_NO=('NO_BORD', ))
    ),
    MODELE=MODFEM
)

NU = NUME_DDL(CHARGE=(CHARDDL, ), MODELE=MODFEM)

RM_ELEM = CALC_MATR_ELEM(
    CHAM_MATER=CHMATER, CHARGE=(CHARDDL, ), MODELE=MODFEM, OPTION='RIGI_MECA'
)

MM_ELEM = CALC_MATR_ELEM(CHAM_MATER=CHMATER, MODELE=MODFEM, OPTION='MASS_MECA')

MR = ASSE_MATRICE(MATR_ELEM=RM_ELEM, NUME_DDL=NU)

MM = ASSE_MATRICE(MATR_ELEM=MM_ELEM, NUME_DDL=NU)

MODES = CALC_MODES(
    CALC_FREQ=_F(NMAX_FREQ=15),
    MATR_MASS=MM,
    MATR_RIGI=MR,
    OPTION='PLUS_PETITE',
    TYPE_RESU='DYNAMIQUE'
)

IMPR_RESU(FORMAT='MED', RESU=_F(RESULTAT=MODES), UNITE=80)

FIN()
